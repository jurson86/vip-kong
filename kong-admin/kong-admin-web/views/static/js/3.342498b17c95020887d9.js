webpackJsonp([3],{CQIe:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=a("BO1k"),r=a.n(s),o=a("Dd8w"),l=a.n(o),i=a("9rMa"),n={data:function(){return{canClick:!0,disabled:!1,formData:{realName:"",username:"",mobile:"",password:"",status:1,groups:[]},groupList:[],rules:{realName:[{required:!0,message:"必填项",trigger:"blur"}],username:[{required:!0,message:"必填项",trigger:"blur"}],password:[{required:!0,message:"必填项",trigger:"blur"}],groups:[{required:!0,message:"必选项",trigger:"change"}]}}},computed:l()({itemId:function(){return this.$route.params.id},titleName:function(){return this.itemId?"修改":"添加"}},Object(i.b)(["suffix"])),created:function(){this.itemId&&(this.getCurGroup(),this.getUserDetail(),this.disabled=!0),this.getGroupList()},methods:{submitForm:function(e){var t=this,a=this.itemId?"/user/update":"/user/add";this.$refs.form.validate(function(e){e&&t.canClick&&(t.canClick=!1,t.$post(a+t.suffix,t.formData).then(function(e){0==e.code?(t.$message({type:"success",message:t.titleName+"成功"}),setTimeout(function(){t.$router.go(-1)},1e3)):(t.canClick=!0,t.$message({type:"warning",message:e.message}))}))})},getUserDetail:function(){var e=this;this.$get("/user/info/"+this.itemId+this.suffix).then(function(t){if(0==t.code){for(var a in t.data)e.formData[a]=t.data[a];e.formData.userId=t.data.userId}else e.$message({type:"warning",message:t.message})})},getGroupList:function(){var e=this;this.$get("/user/group/list"+this.suffix).then(function(t){0==t.code?e.groupList=t.data:e.$message({type:"warning",message:t.message})})},getCurGroup:function(){var e=this;this.$get("/user/group/list/"+this.itemId+this.suffix).then(function(t){if(0==t.code){var a=!0,s=!1,o=void 0;try{for(var l,i=r()(t.data);!(a=(l=i.next()).done);a=!0){var n=l.value;e.formData.groups.push(n.group)}}catch(e){s=!0,o=e}finally{try{!a&&i.return&&i.return()}finally{if(s)throw o}}}else e.$message({type:"warning",message:t.message})})}}},u={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("el-breadcrumb",{attrs:{"separator-class":"el-icon-arrow-right"}},[a("el-breadcrumb-item",{attrs:{to:{name:"home"}}},[e._v("首页")]),e._v(" "),a("el-breadcrumb-item",{attrs:{to:{name:"userList"}}},[e._v("用户列表")]),e._v(" "),a("el-breadcrumb-item",[e._v(e._s(e.titleName)+"用户")])],1),e._v(" "),a("el-card",{staticClass:"form-card"},[a("p",{attrs:{slot:"header"},slot:"header"},[e._v(e._s(e.titleName))]),e._v(" "),a("el-form",{ref:"form",staticClass:"form",attrs:{model:e.formData,rules:e.rules,"label-width":"140px",size:"small"}},[a("el-form-item",{attrs:{label:"真实姓名",prop:"realName"}},[a("el-input",{attrs:{placeholder:"真实姓名"},model:{value:e.formData.realName,callback:function(t){e.$set(e.formData,"realName",t)},expression:"formData.realName"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"登录账号",prop:"username"}},[a("el-input",{attrs:{disabled:e.disabled,placeholder:"登录账号"},model:{value:e.formData.username,callback:function(t){e.$set(e.formData,"username",t)},expression:"formData.username"}})],1),e._v(" "),e.itemId?e._e():a("el-form-item",{attrs:{label:"密码",prop:"password"}},[a("el-input",{attrs:{type:"password",placeholder:"密码"},model:{value:e.formData.password,callback:function(t){e.$set(e.formData,"password",t)},expression:"formData.password"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"用户号码"}},[a("el-input",{attrs:{placeholder:"用户号码"},model:{value:e.formData.mobile,callback:function(t){e.$set(e.formData,"mobile",t)},expression:"formData.mobile"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"组",prop:"groups"}},[a("el-select",{staticClass:"select",attrs:{multiple:"",placeholder:"请选择"},model:{value:e.formData.groups,callback:function(t){e.$set(e.formData,"groups",t)},expression:"formData.groups"}},e._l(e.groupList,function(e,t){return a("el-option",{key:t,attrs:{value:e.group}})}))],1),e._v(" "),a("el-form-item",{attrs:{label:"状态"}},[a("el-select",{staticClass:"select",model:{value:e.formData.status,callback:function(t){e.$set(e.formData,"status",t)},expression:"formData.status"}},[a("el-option",{attrs:{value:0,label:"禁用"}}),e._v(" "),a("el-option",{attrs:{value:1,label:"启用"}})],1)],1),e._v(" "),a("el-form-item",[a("el-button",{attrs:{type:"primary"},on:{click:function(t){e.submitForm("form")}}},[e._v("确定")]),e._v(" "),a("el-button",{on:{click:function(t){e.$router.go(-1)}}},[e._v("取消")])],1)],1)],1)],1)},staticRenderFns:[]},c=a("VU/8")(n,u,!1,null,null,null);t.default=c.exports},cOOO:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=a("Dd8w"),r=a.n(s),o=a("9rMa"),l={data:function(){return{dialogFormVisible:!1,tableData:[],totalCount:0,params:{pageNum:1,pageSize:10,realName:""},formData:{curUserGroup:sessionStorage.getItem("curUserGroup"),username:""},rules:{username:[{required:!0,message:"请输入用户名",trigger:"blur"}]}}},created:function(){this.getTableData()},computed:r()({},Object(o.b)(["suffix","curUserGroup"])),watch:{curUserGroup:function(e){e&&(this.getTableData(),this.formData.curUserGroup=sessionStorage.getItem("curUserGroup"))}},methods:{addItem:function(){this.$router.push({name:"userAdd"})},editItem:function(e){this.$router.push({name:"userEdit",params:{id:e}})},deleteItem:function(e){var t=this;this.$confirm("确认从组中删除该用户吗？","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){t.$get("/user/group/delete/"+e+t.suffix).then(function(e){0==e.code?(t.$message({type:"success",message:"删除成功"}),setTimeout(function(){t.getTableData()},1e3)):t.$message({type:"warning",message:e.message})})}).catch(function(){})},addUserGroup:function(e){var t=this;this.$refs[e].validate(function(e){e&&t.$post("/user/group/add"+t.suffix,{username:t.formData.username}).then(function(e){0==e.code?(t.$message({type:"success",message:"添加组用户成功"}),setTimeout(function(){t.dialogFormVisible=!1,t.getTableData()},1e3)):t.$message({type:"warning",message:e.message})})})},closeDialog:function(){this.$refs.form.resetFields()},changeStatus:function(e){var t=this;this.$confirm("确定修改状态吗？","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){t.$get("/user/update_status/"+t.tableData[e].userId+"/"+t.tableData[e].status+t.suffix).then(function(e){0==e.code?(t.$message({type:"success",message:"修改成功"}),t.getTableData()):t.$message({type:"warning",message:e.message})})}).catch(function(){t.$message({type:"info",message:"已取消修改"})})},getTableData:function(){var e=this;this.$post("/user/list"+this.suffix,this.params).then(function(t){0==t.code?(e.totalCount=t.data.totalCount,e.tableData=t.data.dataList):e.$message({type:"warning",message:t.message})})},changePage:function(e){this.params.pageNum=e,this.getTableData()},searchData:function(){this.params.pageNum=1,this.getTableData()}}},i={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("el-breadcrumb",{attrs:{"separator-class":"el-icon-arrow-right"}},[a("el-breadcrumb-item",{attrs:{to:{name:"home"}}},[e._v("首页")]),e._v(" "),a("el-breadcrumb-item",[e._v("用户列表")])],1),e._v(" "),a("div",{staticClass:"plus"},[a("el-input",{staticStyle:{width:"60%","margin-right":"10px"},attrs:{"prefix-icon":"el-icon-search",placeholder:"请输入真实姓名回车搜索"},nativeOn:{keyup:function(t){return"button"in t||!e._k(t.keyCode,"enter",13,t.key,"Enter")?e.searchData(t):null}},model:{value:e.params.realName,callback:function(t){e.$set(e.params,"realName",t)},expression:"params.realName"}}),e._v(" "),a("el-button",{attrs:{type:"primary",icon:"el-icon-plus",circle:"",title:"新增用户"},on:{click:e.addItem}}),e._v(" "),a("el-button",{attrs:{type:"info",icon:"el-icon-info",circle:"",title:"为当前组添加用户"},on:{click:function(t){e.dialogFormVisible=!0}}})],1),e._v(" "),a("el-table",{attrs:{data:e.tableData,stripe:""}},[a("el-table-column",{attrs:{prop:"realName",label:"真实姓名"}}),e._v(" "),a("el-table-column",{attrs:{sortable:"",prop:"username",label:"登录账号"}}),e._v(" "),a("el-table-column",{attrs:{prop:"mobile",label:"用户号码"}}),e._v(" "),a("el-table-column",{attrs:{label:"状态"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-select",{attrs:{size:"small"},on:{change:function(a){e.changeStatus(t.$index)}},model:{value:t.row.status,callback:function(a){e.$set(t.row,"status",a)},expression:"scope.row.status"}},[a("el-option",{attrs:{value:0,label:"禁用"}}),e._v(" "),a("el-option",{attrs:{value:1,label:"启用"}})],1)]}}])}),e._v(" "),a("el-table-column",{attrs:{sortable:"",prop:"create_time",label:"创建时间"}}),e._v(" "),a("el-table-column",{attrs:{label:"#",width:"180"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-button",{attrs:{type:"warning",icon:"el-icon-edit",circle:"",title:"修改用户"},on:{click:function(a){e.editItem(t.row.userId)}}}),e._v(" "),a("el-button",{attrs:{type:"danger",icon:"el-icon-delete",circle:"",title:"删除用户"},on:{click:function(a){e.deleteItem(t.row.userId)}}})]}}])})],1),e._v(" "),a("el-pagination",{staticClass:"page",attrs:{layout:"total, prev, pager, next","current-page":e.params.pageNum,total:e.totalCount,"page-size":e.params.pageSize},on:{"current-change":e.changePage}}),e._v(" "),a("el-dialog",{attrs:{title:"添加组用户",visible:e.dialogFormVisible,width:"500px"},on:{"update:visible":function(t){e.dialogFormVisible=t},close:e.closeDialog}},[a("el-form",{ref:"form",attrs:{model:e.formData,rules:e.rules,"label-width":"100px",size:"small"}},[a("el-form-item",{attrs:{label:"当前组"}},[a("el-input",{attrs:{disabled:"",placeholder:"当前组"},model:{value:e.formData.curUserGroup,callback:function(t){e.$set(e.formData,"curUserGroup",t)},expression:"formData.curUserGroup"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"用户名",prop:"username"}},[a("el-input",{attrs:{placeholder:"用户名"},model:{value:e.formData.username,callback:function(t){e.$set(e.formData,"username",t)},expression:"formData.username"}})],1),e._v(" "),a("el-form-item",[a("el-button",{attrs:{type:"primary"},on:{click:function(t){e.addUserGroup("form")}}},[e._v("确定")]),e._v(" "),a("el-button",{on:{click:function(t){e.dialogFormVisible=!1}}},[e._v("取消")])],1)],1)],1)],1)},staticRenderFns:[]},n=a("VU/8")(l,i,!1,null,null,null);t.default=n.exports}});