webpackJsonp([2],{"/n6Q":function(e,t,a){a("zQR9"),a("+tPU"),e.exports=a("Kh4W").f("iterator")},"06OY":function(e,t,a){var r=a("3Eo+")("meta"),n=a("EqjI"),l=a("D2L2"),i=a("evD5").f,o=0,u=Object.isExtensible||function(){return!0},s=!a("S82l")(function(){return u(Object.preventExtensions({}))}),c=function(e){i(e,r,{value:{i:"O"+ ++o,w:{}}})},f=e.exports={KEY:r,NEED:!1,fastKey:function(e,t){if(!n(e))return"symbol"==typeof e?e:("string"==typeof e?"S":"P")+e;if(!l(e,r)){if(!u(e))return"F";if(!t)return"E";c(e)}return e[r].i},getWeak:function(e,t){if(!l(e,r)){if(!u(e))return!0;if(!t)return!1;c(e)}return e[r].w},onFreeze:function(e){return s&&f.NEED&&u(e)&&!l(e,r)&&c(e),e}}},"5QVw":function(e,t,a){e.exports={default:a("BwfY"),__esModule:!0}},"7UMu":function(e,t,a){var r=a("R9M2");e.exports=Array.isArray||function(e){return"Array"==r(e)}},BwfY:function(e,t,a){a("fWfb"),a("M6a0"),a("OYls"),a("QWe/"),e.exports=a("FeBl").Symbol},Kh4W:function(e,t,a){t.f=a("dSzd")},LKZe:function(e,t,a){var r=a("NpIQ"),n=a("X8DO"),l=a("TcQ7"),i=a("MmMw"),o=a("D2L2"),u=a("SfB7"),s=Object.getOwnPropertyDescriptor;t.f=a("+E39")?s:function(e,t){if(e=l(e),t=i(t,!0),u)try{return s(e,t)}catch(e){}if(o(e,t))return n(!r.f.call(e,t),e[t])}},NjcD:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=a("mvHQ"),n=a.n(r),l=a("pFYg"),i=a.n(l),o=a("BO1k"),u=a.n(o),s={data:function(){return{pluginsArr:[],formData:{pluginsName:""},rules:{},pluginInfo:[],config:{}}},computed:{breadcrumbName:function(){return this.itemId?"修改":"新增"},itemId:function(){return this.$route.query.id},itemName:function(){return this.$route.query.name},apiName:function(){return this.$route.params.name}},created:function(){this.getPluginsList(),this.itemName&&this.getDetail()},methods:{getPluginsList:function(){var e=this;this.$get("/plugins/enabled").then(function(t){var a=!0,r=!1,n=void 0;try{for(var l,i=u()(t.enabled_plugins);!(a=(l=i.next()).done);a=!0){var o=l.value;o.match(/tdw/)&&e.pluginsArr.push(o)}}catch(e){r=!0,n=e}finally{try{!a&&i.return&&i.return()}finally{if(r)throw n}}})},getPluginInfo:function(e){var t=this;this.pluginInfo=[],this.config={};var a=e||this.formData.pluginsName;this.$get("/plugins/schema/"+a).then(function(e){for(var a in e.fields)t.pluginInfo.push({key:a,value:e.fields[a]});var r=!0,l=!1,o=void 0;try{for(var s,c=u()(t.pluginInfo);!(r=(s=c.next()).done);r=!0){var f=s.value;if(f.value.schema)for(var m in f.value.child=[],f.value.schema.fields){f.value.child.push({key:m,value:f.value.schema.fields[m]});var p=f.value.child,v=!0,d=!1,h=void 0;try{for(var b,g=u()(p);!(v=(b=g.next()).done);v=!0){var y=b.value;"object"!=i()(y.value.default)&&"array"!=typeof y.value.default||y.value.enum||(y.value.default="{}"==n()(y.value.default)?"":n()(y.value.default))}}catch(e){d=!0,h=e}finally{try{!v&&g.return&&g.return()}finally{if(d)throw h}}}!f.value.default||"object"!=i()(f.value.default)&&"array"!=typeof f.value.default||f.value.enum||(f.value.default="{}"==n()(f.value.default)?"":n()(f.value.default))}}catch(e){l=!0,o=e}finally{try{!r&&c.return&&c.return()}finally{if(l)throw o}}})},submitForm:function(e){var t=this,a=!0,r=!1,n=void 0;try{for(var l,i=u()(this.pluginInfo);!(a=(l=i.next()).done);a=!0){var o=l.value;if(!o.value.default&&"boolean"!==o.value.type||o.value.child)if(o.value.child){this.config[o.key]={};var s=!0,c=!1,f=void 0;try{for(var m,p=u()(o.value.child);!(s=(m=p.next()).done);s=!0){var v=m.value;v.value.default||"boolean"===v.value.type?this.config[o.key][v.key]=v.value.default:this.config[o.key][v.key]=""}}catch(e){c=!0,f=e}finally{try{!s&&p.return&&p.return()}finally{if(c)throw f}}}else this.config[o.key]="";else this.config[o.key]=o.value.default}}catch(e){r=!0,n=e}finally{try{!a&&i.return&&i.return()}finally{if(r)throw n}}this.itemId?this.$patch("/plugins/"+this.itemId,{name:this.itemName,config:this.config}).then(function(e){e.config?(t.$message({type:"success",message:"修改成功"}),setTimeout(function(){t.$router.push({name:"apiPlugins"})},1e3)):t.$message.error("修改失败")}):this.$post("/apis/"+this.apiName+"/plugins",{name:this.formData.pluginsName,config:this.config}).then(function(e){e.config?(t.$message({type:"success",message:"新增成功"}),setTimeout(function(){t.$router.push({name:"apiPlugins"})},1e3)):t.$message.error("新增失败")})},getDetail:function(){var e=this;this.getPluginInfo(this.itemName);var t=[];this.$get("/apis/"+this.apiName+"/plugins/"+this.itemId).then(function(a){for(var r in a.config)t.push({key:r,value:{default:a.config[r]}});var l=!0,o=!1,s=void 0;try{for(var c,f=u()(e.pluginInfo);!(l=(c=f.next()).done);l=!0){var m=c.value,p=!0,v=!1,d=void 0;try{for(var h,b=u()(t);!(p=(h=b.next()).done);p=!0){var g=h.value;if(m.value.child)for(var y in g.value.child=[],a.config)for(var _ in a.config[y]){var D=!0,x=!1,$=void 0;try{for(var k,w=u()(m.value.child);!(D=(k=w.next()).done);D=!0){var N=k.value;y==g.key&&N.key==_&&g.value.child.push({key:_,value:{default:a.config[y][_],type:N.value.type}})}}catch(e){x=!0,$=e}finally{try{!D&&w.return&&w.return()}finally{if(x)throw $}}}else m.key==g.key&&(g.value.type=m.value.type,m.value.enum&&(g.value.enum=m.value.enum,"{}"===n()(g.value.default)&&(g.value.default=[])))}}catch(e){v=!0,d=e}finally{try{!p&&b.return&&b.return()}finally{if(v)throw d}}}}catch(e){o=!0,s=e}finally{try{!l&&f.return&&f.return()}finally{if(o)throw s}}e.pluginInfo=t;var I=!0,P=!1,T=void 0;try{for(var S,O=u()(e.pluginInfo);!(I=(S=O.next()).done);I=!0){var E=S.value;if(!E.value.default||"object"!=i()(E.value.default)&&"array"!=typeof E.value.default||E.value.enum||(E.value.default="{}"==n()(E.value.default)?"":n()(E.value.default)),E.value.child){var C=E.value.child,j=!0,A=!1,z=void 0;try{for(var U,M=u()(C);!(j=(U=M.next()).done);j=!0){var F=U.value;"object"!=i()(F.value.default)&&"array"!=typeof F.value.default||F.value.enum||(F.value.default="{}"==n()(F.value.default)?"":n()(F.value.default))}}catch(e){A=!0,z=e}finally{try{!j&&M.return&&M.return()}finally{if(A)throw z}}}}}catch(e){P=!0,T=e}finally{try{!I&&O.return&&O.return()}finally{if(P)throw T}}})}}},c={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("el-breadcrumb",{attrs:{"separator-class":"el-icon-arrow-right"}},[a("el-breadcrumb-item",{attrs:{to:{name:"home"}}},[e._v("首页")]),e._v(" "),a("el-breadcrumb-item",{attrs:{to:{name:"apis"}}},[e._v("APIs")]),e._v(" "),a("el-breadcrumb-item",{attrs:{to:{name:"apiPlugins"}}},[e._v(e._s(e.apiName)+"的插件")]),e._v(" "),a("el-breadcrumb-item",[e._v(e._s(e.breadcrumbName))])],1),e._v(" "),a("el-card",{staticClass:"form-card"},[a("p",{attrs:{slot:"header"},slot:"header"},[e._v(e._s(e.breadcrumbName))]),e._v(" "),a("el-form",{ref:"form",staticClass:"form-lg",attrs:{model:e.formData,rules:e.rules,"label-width":"240px",size:"small"}},[a("el-form-item",{attrs:{label:"Api名称"}},[a("el-input",{attrs:{disabled:""},model:{value:e.apiName,callback:function(t){e.apiName=t},expression:"apiName"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"插件名"}},[e.itemId?e._e():a("el-select",{staticClass:"select-sm",on:{change:e.getPluginInfo},model:{value:e.formData.pluginsName,callback:function(t){e.$set(e.formData,"pluginsName",t)},expression:"formData.pluginsName"}},e._l(e.pluginsArr,function(t){return a("el-option",{key:t,attrs:{value:t}},[e._v(e._s(t))])})),e._v(" "),e.itemId?a("el-input",{attrs:{disabled:""},model:{value:e.itemName,callback:function(t){e.itemName=t},expression:"itemName"}}):e._e()],1),e._v(" "),e.formData.pluginsName||e.itemName?[e._l(e.pluginInfo,function(t,r){return a("el-form-item",{key:r,attrs:{label:t.key}},[t.value.child?[a("el-card",{attrs:{shadow:"hover"}},e._l(t.value.child,function(t,r){return a("div",{key:r,staticClass:"child-info"},[a("span",[e._v(e._s(t.key))]),e._v(" "),"number"!=t.value.type&&"boolean"!=t.value.type?a("el-input",{model:{value:t.value.default,callback:function(a){e.$set(t.value,"default",a)},expression:"subItem.value.default"}}):e._e(),e._v(" "),"number"==t.value.type?a("el-input-number",{attrs:{"controls-position":"right",min:1},model:{value:t.value.default,callback:function(a){e.$set(t.value,"default",a)},expression:"subItem.value.default"}}):e._e(),e._v(" "),"boolean"==t.value.type?a("el-checkbox",{model:{value:t.value.default,callback:function(a){e.$set(t.value,"default",a)},expression:"subItem.value.default"}},[e._v(e._s(t.key))]):e._e()],1)}))]:["string"==t.value.type&&!t.value.enum||"array"==t.value.type&&!t.value.enum||"url"==t.value.type?a("el-input",{model:{value:t.value.default,callback:function(a){e.$set(t.value,"default",a)},expression:"item.value.default"}}):e._e(),e._v(" "),"number"==t.value.type?a("el-input-number",{attrs:{"controls-position":"right"},model:{value:t.value.default,callback:function(a){e.$set(t.value,"default",a)},expression:"item.value.default"}}):e._e(),e._v(" "),t.value.enum?a("el-select",{staticClass:"select-sm",attrs:{multiple:"array"==t.value.type},model:{value:t.value.default,callback:function(a){e.$set(t.value,"default",a)},expression:"item.value.default"}},e._l(t.value.enum,function(t){return a("el-option",{key:t,attrs:{value:t}},[e._v(e._s(t))])})):e._e(),e._v(" "),"boolean"==t.value.type?a("el-checkbox",{model:{value:t.value.default,callback:function(a){e.$set(t.value,"default",a)},expression:"item.value.default"}},[e._v(e._s(t.key))]):e._e()]],2)}),e._v(" "),a("el-form-item",[a("el-button",{attrs:{type:"primary"},on:{click:function(t){e.submitForm("form")}}},[e._v("确定")]),e._v(" "),a("el-button",{on:{click:function(t){e.$router.go(-1)}}},[e._v("取消")])],1)]:e._e()],2)],1)],1)},staticRenderFns:[]},f=a("VU/8")(s,c,!1,null,null,null);t.default=f.exports},OYls:function(e,t,a){a("crlp")("asyncIterator")},"QWe/":function(e,t,a){a("crlp")("observable")},Rrel:function(e,t,a){var r=a("TcQ7"),n=a("n0T6").f,l={}.toString,i="object"==typeof window&&window&&Object.getOwnPropertyNames?Object.getOwnPropertyNames(window):[];e.exports.f=function(e){return i&&"[object Window]"==l.call(e)?function(e){try{return n(e)}catch(e){return i.slice()}}(e):n(r(e))}},Xc4G:function(e,t,a){var r=a("lktj"),n=a("1kS7"),l=a("NpIQ");e.exports=function(e){var t=r(e),a=n.f;if(a)for(var i,o=a(e),u=l.f,s=0;o.length>s;)u.call(e,i=o[s++])&&t.push(i);return t}},Zzip:function(e,t,a){e.exports={default:a("/n6Q"),__esModule:!0}},crlp:function(e,t,a){var r=a("7KvD"),n=a("FeBl"),l=a("O4g8"),i=a("Kh4W"),o=a("evD5").f;e.exports=function(e){var t=n.Symbol||(n.Symbol=l?{}:r.Symbol||{});"_"==e.charAt(0)||e in t||o(t,e,{value:i.f(e)})}},fWfb:function(e,t,a){"use strict";var r=a("7KvD"),n=a("D2L2"),l=a("+E39"),i=a("kM2E"),o=a("880/"),u=a("06OY").KEY,s=a("S82l"),c=a("e8AB"),f=a("e6n0"),m=a("3Eo+"),p=a("dSzd"),v=a("Kh4W"),d=a("crlp"),h=a("Xc4G"),b=a("7UMu"),g=a("77Pl"),y=a("EqjI"),_=a("TcQ7"),D=a("MmMw"),x=a("X8DO"),$=a("Yobk"),k=a("Rrel"),w=a("LKZe"),N=a("evD5"),I=a("lktj"),P=w.f,T=N.f,S=k.f,O=r.Symbol,E=r.JSON,C=E&&E.stringify,j=p("_hidden"),A=p("toPrimitive"),z={}.propertyIsEnumerable,U=c("symbol-registry"),M=c("symbols"),F=c("op-symbols"),B=Object.prototype,Q="function"==typeof O,K=r.QObject,Y=!K||!K.prototype||!K.prototype.findChild,W=l&&s(function(){return 7!=$(T({},"a",{get:function(){return T(this,"a",{value:7}).a}})).a})?function(e,t,a){var r=P(B,t);r&&delete B[t],T(e,t,a),r&&e!==B&&T(B,t,r)}:T,G=function(e){var t=M[e]=$(O.prototype);return t._k=e,t},q=Q&&"symbol"==typeof O.iterator?function(e){return"symbol"==typeof e}:function(e){return e instanceof O},L=function(e,t,a){return e===B&&L(F,t,a),g(e),t=D(t,!0),g(a),n(M,t)?(a.enumerable?(n(e,j)&&e[j][t]&&(e[j][t]=!1),a=$(a,{enumerable:x(0,!1)})):(n(e,j)||T(e,j,x(1,{})),e[j][t]=!0),W(e,t,a)):T(e,t,a)},R=function(e,t){g(e);for(var a,r=h(t=_(t)),n=0,l=r.length;l>n;)L(e,a=r[n++],t[a]);return e},J=function(e){var t=z.call(this,e=D(e,!0));return!(this===B&&n(M,e)&&!n(F,e))&&(!(t||!n(this,e)||!n(M,e)||n(this,j)&&this[j][e])||t)},V=function(e,t){if(e=_(e),t=D(t,!0),e!==B||!n(M,t)||n(F,t)){var a=P(e,t);return!a||!n(M,t)||n(e,j)&&e[j][t]||(a.enumerable=!0),a}},H=function(e){for(var t,a=S(_(e)),r=[],l=0;a.length>l;)n(M,t=a[l++])||t==j||t==u||r.push(t);return r},X=function(e){for(var t,a=e===B,r=S(a?F:_(e)),l=[],i=0;r.length>i;)!n(M,t=r[i++])||a&&!n(B,t)||l.push(M[t]);return l};Q||(o((O=function(){if(this instanceof O)throw TypeError("Symbol is not a constructor!");var e=m(arguments.length>0?arguments[0]:void 0),t=function(a){this===B&&t.call(F,a),n(this,j)&&n(this[j],e)&&(this[j][e]=!1),W(this,e,x(1,a))};return l&&Y&&W(B,e,{configurable:!0,set:t}),G(e)}).prototype,"toString",function(){return this._k}),w.f=V,N.f=L,a("n0T6").f=k.f=H,a("NpIQ").f=J,a("1kS7").f=X,l&&!a("O4g8")&&o(B,"propertyIsEnumerable",J,!0),v.f=function(e){return G(p(e))}),i(i.G+i.W+i.F*!Q,{Symbol:O});for(var Z="hasInstance,isConcatSpreadable,iterator,match,replace,search,species,split,toPrimitive,toStringTag,unscopables".split(","),ee=0;Z.length>ee;)p(Z[ee++]);for(var te=I(p.store),ae=0;te.length>ae;)d(te[ae++]);i(i.S+i.F*!Q,"Symbol",{for:function(e){return n(U,e+="")?U[e]:U[e]=O(e)},keyFor:function(e){if(!q(e))throw TypeError(e+" is not a symbol!");for(var t in U)if(U[t]===e)return t},useSetter:function(){Y=!0},useSimple:function(){Y=!1}}),i(i.S+i.F*!Q,"Object",{create:function(e,t){return void 0===t?$(e):R($(e),t)},defineProperty:L,defineProperties:R,getOwnPropertyDescriptor:V,getOwnPropertyNames:H,getOwnPropertySymbols:X}),E&&i(i.S+i.F*(!Q||s(function(){var e=O();return"[null]"!=C([e])||"{}"!=C({a:e})||"{}"!=C(Object(e))})),"JSON",{stringify:function(e){for(var t,a,r=[e],n=1;arguments.length>n;)r.push(arguments[n++]);if(a=t=r[1],(y(t)||void 0!==e)&&!q(e))return b(t)||(t=function(e,t){if("function"==typeof a&&(t=a.call(this,e,t)),!q(t))return t}),r[1]=t,C.apply(E,r)}}),O.prototype[A]||a("hJx8")(O.prototype,A,O.prototype.valueOf),f(O,"Symbol"),f(Math,"Math",!0),f(r.JSON,"JSON",!0)},hiTm:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=a("Dd8w"),n=a.n(r),l=a("9rMa"),i={mixins:[a("ScGb").a],data:function(){return{page:1,totalCount:0,size:10,nextUrl:"",tableData:[]}},created:function(){this.getTableData()},computed:n()({itemName:function(){return this.$route.params.name}},Object(l.b)(["curUserGroup"])),watch:{curUserGroup:function(e){var t=this;e&&(this.getKongUrl(),setTimeout(function(){t.$router.push({name:"apis"})},1e3))}},methods:{addItem:function(){this.$router.push({name:"apiPluginsAdd"})},editItem:function(e,t){this.$router.push({name:"apiPluginsEdit",query:{id:e,name:t}})},deleteItem:function(e){var t=this;this.$confirm("确定删除吗？","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){var a="/apis/"+t.itemName+"/plugins/"+e;t.$delete(a).then(function(e){204==e.status?(t.$message({type:"success",message:"删除成功"}),t.getTableData()):t.$message.error("删除失败")})}).catch(function(){t.$message({type:"info",message:"已取消删除"})})},changePage:function(e){var t=this;1==e?this.getTableData():(this.nextUrl=this.Base64(e.toString()),this.$get("/apis/"+this.itemName+"/plugins?size="+this.size+"&offset="+this.nextUrl).then(function(e){t.formatTableData(e)}))},getTableData:function(){var e=this,t="/apis/"+this.itemName+"/plugins?size="+this.size;this.$get(t).then(function(t){e.totalCount=t.total,e.formatTableData(t)})},formatTableData:function(e){e.total>this.size&&e.next&&(this.nextUrl=e.offset),this.tableData=e.data;for(var t=0;t<e.data.length;t++){var a=e.data[t];this.tableData[t].created_at=this.formatDateTime(a.created_at),this.tableData[t].api=this.itemName}},changeEnable:function(e){var t=this;this.$confirm("确定修改吗？","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){t.$patch("/plugins/"+t.tableData[e].id,{enabled:t.tableData[e].enabled}).then(function(e){t.$message({type:"success",message:"修改成功"}),t.getTableData()})}).catch(function(){t.$message({type:"info",message:"已取消修改"}),t.getTableData()})}}},o={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("el-breadcrumb",{attrs:{"separator-class":"el-icon-arrow-right"}},[a("el-breadcrumb-item",{attrs:{to:{name:"home"}}},[e._v("首页")]),e._v(" "),a("el-breadcrumb-item",{attrs:{to:{name:"apis"}}},[e._v("APIs")]),e._v(" "),a("el-breadcrumb-item",[e._v(e._s(e.itemName)+"的插件")])],1),e._v(" "),a("el-button",{staticClass:"plus",attrs:{type:"primary",icon:"el-icon-plus",circle:""},on:{click:e.addItem}}),e._v(" "),a("el-table",{attrs:{data:e.tableData,stripe:""}},[a("el-table-column",{attrs:{prop:"name",label:"Name"}}),e._v(" "),a("el-table-column",{attrs:{prop:"api",label:"API"}}),e._v(" "),a("el-table-column",{attrs:{label:"Status"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-switch",{attrs:{"active-text":"on","inactive-text":"off"},on:{change:function(a){e.changeEnable(t.$index)}},model:{value:t.row.enabled,callback:function(a){e.$set(t.row,"enabled",a)},expression:"scope.row.enabled"}})]}}])}),e._v(" "),a("el-table-column",{attrs:{prop:"created_at",label:"Created"}}),e._v(" "),a("el-table-column",{attrs:{label:"#",width:"180"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-button",{attrs:{type:"primary",icon:"el-icon-edit",circle:""},on:{click:function(a){e.editItem(t.row.id,t.row.name)}}}),e._v(" "),a("el-button",{attrs:{type:"danger",icon:"el-icon-delete",circle:""},on:{click:function(a){e.deleteItem(t.row.id)}}})]}}])})],1),e._v(" "),a("el-pagination",{staticClass:"page",attrs:{layout:"total, prev, pager, next","current-page":e.page,total:e.totalCount,"page-size":e.size},on:{"current-change":e.changePage}})],1)},staticRenderFns:[]},u=a("VU/8")(i,o,!1,null,null,null);t.default=u.exports},hrH7:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=a("pFYg"),n=a.n(r),l={data:function(){return{formData:{name:"",uris:"",methods:"",upstream_url:"",strip_uri:!0,retries:5,upstream_connect_timeout:6e4,upstream_send_timeout:6e4,upstream_read_timeout:6e4,https_only:!1},rules:{name:[{required:!0,message:"名称是必填项",trigger:"blur"}],upstream_url:[{required:!0,message:"upstream_url是必填项",trigger:"blur"}],uris:[{required:!0,message:"必填项",trigger:"blur"}],methods:[{required:!0,message:"必选项",trigger:"change"}]}}},computed:{breadcrumbName:function(){return this.itemName?"编辑 API":"添加 API"},itemName:function(){return this.$route.params.itemName}},created:function(){this.itemName&&this.getDetail()},methods:{submitForm:function(e){var t=this;this.$refs[e].validate(function(e){e?t.itemName?t.$patch("/apis/"+t.itemName,t.formData).then(function(e){"object"===(void 0===e?"undefined":n()(e))&&(t.$message({message:"修改成功！",type:"success"}),setTimeout(function(){t.$router.push({name:"apis"})},1e3))}):t.$post("/apis",t.formData).then(function(e){"object"===(void 0===e?"undefined":n()(e))?(t.$message({message:"新增成功！",type:"success"}),setTimeout(function(){t.$router.push({name:"apis"})},1e3)):t.$message.error("新增失败！")}):t.$message({type:"warning",message:"缺少必填项或填写有误！"})})},getDetail:function(){var e=this;this.$get("/apis/"+this.itemName).then(function(t){e.formData=t,e.formData.methods=t.methods.toString(),e.formData.uris=t.uris.toString()})}}},i={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("el-breadcrumb",{attrs:{"separator-class":"el-icon-arrow-right"}},[a("el-breadcrumb-item",{attrs:{to:{name:"home"}}},[e._v("首页")]),e._v(" "),a("el-breadcrumb-item",{attrs:{to:{name:"apis"}}},[e._v("APIs")]),e._v(" "),a("el-breadcrumb-item",[e._v(e._s(e.breadcrumbName))])],1),e._v(" "),a("el-card",{staticClass:"form-card"},[a("p",{attrs:{slot:"header"},slot:"header"},[e._v(e._s(e.breadcrumbName))]),e._v(" "),a("el-form",{ref:"form",staticClass:"form",attrs:{model:e.formData,rules:e.rules,"label-width":"140px",size:"small"}},[a("el-form-item",{attrs:{label:"名称",prop:"name"}},[a("el-input",{attrs:{placeholder:"API名称"},model:{value:e.formData.name,callback:function(t){e.$set(e.formData,"name",t)},expression:"formData.name"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"uris",prop:"uris"}},[a("el-input",{attrs:{placeholder:"API的uris前缀列表"},model:{value:e.formData.uris,callback:function(t){e.$set(e.formData,"uris",t)},expression:"formData.uris"}}),e._v(" "),a("p",{staticClass:"text"},[e._v("例如：/my-path。至少应指定一个uris。")])],1),e._v(" "),a("el-form-item",{attrs:{label:"请求方法",prop:"methods"}},[a("el-select",{staticClass:"select",attrs:{clearable:"",placeholder:"请选择HTTP请求方式"},model:{value:e.formData.methods,callback:function(t){e.$set(e.formData,"methods",t)},expression:"formData.methods"}},[a("el-option",{attrs:{value:"GET"}}),e._v(" "),a("el-option",{attrs:{value:"POST"}}),e._v(" "),a("el-option",{attrs:{value:"PUT"}}),e._v(" "),a("el-option",{attrs:{value:"PATCH"}}),e._v(" "),a("el-option",{attrs:{value:"DELETE"}}),e._v(" "),a("el-option",{attrs:{value:"OPTIONS"}}),e._v(" "),a("el-option",{attrs:{value:"HEAD"}})],1)],1),e._v(" "),a("el-form-item",{attrs:{label:"网址",prop:"upstream_url"}},[a("el-input",{attrs:{placeholder:"服务器地址"},model:{value:e.formData.upstream_url,callback:function(t){e.$set(e.formData,"upstream_url",t)},expression:"formData.upstream_url"}}),e._v(" "),a("p",{staticClass:"text"},[e._v("该url将用于代理请求。例如：http://example.com，格式：http://{upstreamName}。")])],1),e._v(" "),a("el-form-item",{attrs:{label:"是否去掉uris前缀"}},[a("el-checkbox",{model:{value:e.formData.strip_uri,callback:function(t){e.$set(e.formData,"strip_uri",t)},expression:"formData.strip_uri"}},[e._v("是")]),e._v(" "),a("p",{staticClass:"text"},[e._v("当通过uris前缀匹配API时，应去掉请求地址中的前缀。默认true。")])],1),e._v(" "),a("el-form-item",{attrs:{label:"重连次数"}},[a("el-input-number",{attrs:{min:1,max:99999},model:{value:e.formData.retries,callback:function(t){e.$set(e.formData,"retries",t)},expression:"formData.retries"}}),e._v(" "),a("p",{staticClass:"text"},[e._v("未能请求成功时的重连次数。默认5次。")])],1),e._v(" "),a("el-form-item",{attrs:{label:"连接超时时间"}},[a("el-input-number",{attrs:{min:1,max:999999},model:{value:e.formData.upstream_connect_timeout,callback:function(t){e.$set(e.formData,"upstream_connect_timeout",t)},expression:"formData.upstream_connect_timeout"}}),e._v(" "),a("p",{staticClass:"text"},[e._v("与服务器建立连接的超时时间（以毫秒为单位），默认60000ms。")])],1),e._v(" "),a("el-form-item",{attrs:{label:"发送超时时间"}},[a("el-input-number",{attrs:{min:1,max:999999},model:{value:e.formData.upstream_send_timeout,callback:function(t){e.$set(e.formData,"upstream_send_timeout",t)},expression:"formData.upstream_send_timeout"}}),e._v(" "),a("p",{staticClass:"text"},[e._v("连续两次向服务器请求写操作之间的超时时间（以毫秒为单位），默认60000ms。")])],1),e._v(" "),a("el-form-item",{attrs:{label:"读取超时时间"}},[a("el-input-number",{attrs:{min:1,max:999999},model:{value:e.formData.upstream_read_timeout,callback:function(t){e.$set(e.formData,"upstream_read_timeout",t)},expression:"formData.upstream_read_timeout"}}),e._v(" "),a("p",{staticClass:"text"},[e._v("连续两次向服务器请求读取操作之间的超时时间（以毫秒为单位），默认60000ms。")])],1),e._v(" "),a("el-form-item",{attrs:{label:"是否只允许https"}},[a("el-checkbox",{model:{value:e.formData.https_only,callback:function(t){e.$set(e.formData,"https_only",t)},expression:"formData.https_only"}},[e._v("是")]),e._v(" "),a("p",{staticClass:"text"},[e._v("如果想仅通过https访问API，请选用合适的端口号(默认为8443)。默认false。")])],1),e._v(" "),a("el-form-item",[a("el-button",{attrs:{type:"primary"},on:{click:function(t){e.submitForm("form")}}},[e._v("确定")]),e._v(" "),a("el-button",{on:{click:function(t){e.$router.go(-1)}}},[e._v("取消")])],1)],1)],1)],1)},staticRenderFns:[]},o=a("VU/8")(l,i,!1,null,null,null);t.default=o.exports},n0T6:function(e,t,a){var r=a("Ibhu"),n=a("xnc9").concat("length","prototype");t.f=Object.getOwnPropertyNames||function(e){return r(e,n)}},pFYg:function(e,t,a){"use strict";t.__esModule=!0;var r=i(a("Zzip")),n=i(a("5QVw")),l="function"==typeof n.default&&"symbol"==typeof r.default?function(e){return typeof e}:function(e){return e&&"function"==typeof n.default&&e.constructor===n.default&&e!==n.default.prototype?"symbol":typeof e};function i(e){return e&&e.__esModule?e:{default:e}}t.default="function"==typeof n.default&&"symbol"===l(r.default)?function(e){return void 0===e?"undefined":l(e)}:function(e){return e&&"function"==typeof n.default&&e.constructor===n.default&&e!==n.default.prototype?"symbol":void 0===e?"undefined":l(e)}},wvA0:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=a("Dd8w"),n=a.n(r),l=a("9rMa"),i={mixins:[a("ScGb").a],data:function(){return{page:1,totalCount:0,size:10,nextUrl:"",tableData:[]}},created:function(){this.getTableData()},computed:n()({},Object(l.b)(["curUserGroup"])),watch:{curUserGroup:function(e){var t=this;e&&(this.getKongUrl(),setTimeout(function(){t.getTableData()},1e3))}},methods:{changePage:function(e){var t=this;1==e?this.getTableData():(this.nextUrl=this.Base64(e.toString()),this.$get("/apis?size="+this.size+"&offset="+this.nextUrl).then(function(e){t.formatTableData(e)}))},getTableData:function(){var e=this;this.$get("/apis?size="+this.size).then(function(t){e.totalCount=t.total,e.formatTableData(t)})},formatTableData:function(e){e.total>this.size&&e.next&&(this.nextUrl=e.offset),this.tableData=e.data;for(var t=0;t<e.data.length;t++){var a=e.data[t];this.tableData[t].created_at=this.formatDateTime(a.created_at),a.uris&&a.uris.length>1&&(this.tableData[t].uris=a.uris.join(","))}},addItem:function(){this.$router.push({name:"apisAdd"})},editItem:function(e){this.$router.push({name:"apisEdit",params:{itemName:e}})},deleteItem:function(e){var t=this;this.$confirm('确定删除API "'+e+'"',"提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){t.$delete("/apis/"+e).then(function(e){204==e.status?(t.$message({type:"success",message:"删除成功"}),t.getTableData()):t.$message.error("删除失败")})}).catch(function(){t.$message({type:"info",message:"已取消删除"})})},toPlugins:function(e){this.$router.push({name:"apiPlugins",params:{name:e}})}}},o={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("el-breadcrumb",{attrs:{"separator-class":"el-icon-arrow-right"}},[a("el-breadcrumb-item",{attrs:{to:{name:"home"}}},[e._v("首页")]),e._v(" "),a("el-breadcrumb-item",[e._v("APIs")])],1),e._v(" "),a("el-button",{staticClass:"plus",attrs:{type:"primary",icon:"el-icon-plus",circle:""},on:{click:e.addItem}}),e._v(" "),a("el-table",{attrs:{"default-sort":{prop:"name"},data:e.tableData,stripe:""}},[a("el-table-column",{attrs:{sortable:"",prop:"name",label:"Name"}}),e._v(" "),a("el-table-column",{attrs:{prop:"uris",label:"Uri(s)"}}),e._v(" "),a("el-table-column",{attrs:{prop:"methods",label:"Method(s)"}}),e._v(" "),a("el-table-column",{attrs:{prop:"upstream_url",label:"Upstream url"}}),e._v(" "),a("el-table-column",{attrs:{sortable:"",prop:"created_at",label:"Created"}}),e._v(" "),a("el-table-column",{attrs:{label:"#",width:"180"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-button",{attrs:{type:"primary",icon:"el-icon-edit",circle:""},on:{click:function(a){e.editItem(t.row.name)}}}),e._v(" "),a("el-button",{attrs:{type:"warning",icon:"el-icon-setting",circle:""},on:{click:function(a){e.toPlugins(t.row.name)}}}),e._v(" "),a("el-button",{attrs:{type:"danger",icon:"el-icon-delete",circle:""},on:{click:function(a){e.deleteItem(t.row.name)}}})]}}])})],1),e._v(" "),a("el-pagination",{staticClass:"page",attrs:{layout:"total, prev, pager, next","current-page":e.page,total:e.totalCount,"page-size":e.size},on:{"current-change":e.changePage}})],1)},staticRenderFns:[]},u=a("VU/8")(i,o,!1,null,null,null);t.default=u.exports}});